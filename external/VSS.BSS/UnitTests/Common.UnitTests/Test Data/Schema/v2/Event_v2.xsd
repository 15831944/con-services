<?xml version="1.0" encoding="UTF-8"?>
<schema xmlns="http://www.w3.org/2001/XMLSchema"
	targetNamespace="http://www.cat.com/em/feed/v2/Event"
	xmlns:event="http://www.cat.com/em/feed/v2/Event"
	xmlns:feed="http://www.cat.com/em/feed/v2/CommonFeed"
	elementFormDefault="unqualified"
	xmlns:pref="http://www.cat.com/em/feed/v2/CommonFeed">

	<import namespace="http://www.cat.com/em/feed/v2/CommonFeed" schemaLocation="CommonSchema_v2.xsd"></import>
	
	<complexType name="Message">
		<annotation>
			<documentation>
				Delivers ECM (Electronic Control Module) event data. Each event is represented by four data elements: the event level, the module ID (MID) reporting the event, the event identifier, and the event timestamp.
				One of the three faults generated onboard the ECM. An event refers to detection of a predefined or out-of-range or abnormal condition within the machine, engine, or system it monitors. 
			</documentation>
		</annotation>
		<sequence>
			<element name="header" type="feed:TopicHeader" minOccurs="1" maxOccurs="1"/>
			<element name="numberOfEvents" minOccurs="1" maxOccurs="1">
				<simpleType>
					<restriction base="long">	
						<minInclusive value="1"></minInclusive>
						<maxInclusive value="17"></maxInclusive>
					</restriction>
				</simpleType>
			</element>
			<element name="eventBlock" type="event:EventBlock" minOccurs="1" maxOccurs="1"/>
		</sequence>
	</complexType>

	<element name="topic" type="event:TopicBlock">
		<annotation>
			<documentation>
				Is one of the three faults generated on-board the ECM. 
				An Event refers to detection of a predefined or out-of-range or 
				abnormal condition within the machine, engine, or system it monitors. 
			</documentation>
		</annotation>
	</element>

	<complexType name="TopicBlock">
		<sequence>
            <element name="nextBuffer" type="feed:NextBuffer" minOccurs="1" maxOccurs="1"/>
            <element name="message" type="event:Message" minOccurs="1" maxOccurs="unbounded"/>
		</sequence>
	</complexType>

	<complexType name="EventBlock">
       	<sequence>
			<element name="event" type="event:Event" minOccurs="1" maxOccurs="17"/>
       	</sequence>
	</complexType>

	<complexType name="Event">
		<sequence>
			<element name="level" minOccurs="1" maxOccurs="1">
                <annotation>
                	<documentation>
                		Fault severity codes: (0 - 1: Normal/ Green, 2:Monitor/ Yellow, 3:Action/ Red)
                	</documentation>
                </annotation>
                <simpleType>
					<restriction base="int">
						<enumeration value="0"></enumeration>
						<enumeration value="1"></enumeration>
						<enumeration value="2"></enumeration>
						<enumeration value="3"></enumeration>
					</restriction>
				</simpleType>
			</element>
			<element name="mid" minOccurs="1" maxOccurs="1" type="int">
                <annotation>
                	<documentation>
                		The Electronic Control Module (ECM) Identifier
                		from which the event was generated
                	</documentation>
                </annotation>
			</element>
			<element name="eid" minOccurs="1" maxOccurs="1" type="int">
                <annotation>
                	<documentation>
                		The Event Identifier
                	</documentation>
                </annotation>
			</element>
			<element name="occurances" minOccurs="1" maxOccurs="1" type="int">
                <annotation>
                	<documentation>
                		The number of times the event has occurred for
                		the ECM before reset
                	</documentation>
                </annotation>
			</element>
			<element name="timestamp" type="string" minOccurs="1" maxOccurs="1">
				<annotation>
					<documentation>
						The Event time stamp expressed as the Service
						Meter Hour or Date/Time of the Event
					</documentation>
				</annotation>
			</element>
		</sequence>
	</complexType>
	
</schema>