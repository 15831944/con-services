ARG FROM_IMAGE
FROM ${FROM_IMAGE}

ARG SERVICE_PATH
WORKDIR /build/${SERVICE_PATH}

RUN find . -name "*Tests.csproj" -print0 | tar -cvf unittestprojects.tar --null -T -
RUN tar -x -f unittestprojects.tar --to-command 'dotnet test $TAR_FILENAME /p:CollectCoverage=true /p:CoverletOutputFormat=cobertura /p:CoverletOutput="/build/${SERVICE_PATH}/UnitTestResults/" --logger xunit --results-directory UnitTestResults -nowarn:NU1701'
